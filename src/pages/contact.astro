---
import Layout from "../layouts/Layout.astro";
import { siteConfig } from "../config/site";
import Button from "../components/ui/Button.astro";
import { Phone, Mail, MapPin, AlertCircle } from "lucide-react";

const title = "Contact Us";
const description = "Get in touch with Ethyl Merc Group for quotes, service requests, or partnership enquiries.";

const serviceAreas = [
  { name: "Whangārei",     x: 52,  y: 68  },
  { name: "Auckland",      x: 47,  y: 112 },
  { name: "Hamilton",      x: 44,  y: 148 },
  { name: "Tauranga",      x: 72,  y: 148 },
  { name: "Wellington",    x: 58,  y: 318 },
  { name: "Christchurch",  x: 52,  y: 438 },
  { name: "Queenstown",    x: 34,  y: 510 },
  { name: "Dunedin",       x: 58,  y: 520 },
];
---

<Layout title={title} description={description}>
  <section class="bg-primary text-white py-20">
    <div class="container mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-5xl font-heading font-bold mb-6">Contact Us</h1>
      <p class="text-slate-300 text-lg max-w-2xl mx-auto">
        Whether you have a commercial project, a residential repair, or want to join our collective, we're here to help.
      </p>
    </div>
  </section>

  <section class="py-16 container mx-auto px-4">
    <div class="grid lg:grid-cols-2 gap-16 max-w-6xl mx-auto">
      
      {/* Contact Info & Urgent Box */}
      <div class="space-y-12">
        <div>
          <h2 class="text-2xl font-heading font-bold text-primary mb-8">Get in Touch</h2>
          <div class="space-y-6">
            <div class="flex items-start gap-4">
               <div class="w-10 h-10 bg-neutral-light rounded-full flex items-center justify-center flex-shrink-0 text-accent">
                 <Phone className="w-5 h-5" />
               </div>
               <div>
                  <h3 class="font-bold text-slate-900">Phone</h3>
                  <a href={`tel:${siteConfig.contact.phone.replace(/\s/g, '')}`} class="text-lg text-slate-600 hover:text-accent transition-colors block mt-1">
                    {siteConfig.contact.phone}
                  </a>
                  <p class="text-sm text-slate-400 mt-1">Available 24/7 for account holders</p>
               </div>
            </div>

            <div class="flex items-start gap-4">
               <div class="w-10 h-10 bg-neutral-light rounded-full flex items-center justify-center flex-shrink-0 text-accent">
                 <Mail className="w-5 h-5" />
               </div>
               <div>
                  <h3 class="font-bold text-slate-900">Email</h3>
                  <a href={`mailto:${siteConfig.contact.email}`} class="text-lg text-slate-600 hover:text-accent transition-colors block mt-1">
                    {siteConfig.contact.email}
                  </a>
               </div>
            </div>

            <div class="flex items-start gap-4">
               <div class="w-10 h-10 bg-neutral-light rounded-full flex items-center justify-center flex-shrink-0 text-accent">
                 <MapPin className="w-5 h-5" />
               </div>
               <div>
                  <h3 class="font-bold text-slate-900">Head Office</h3>
                  <p class="text-lg text-slate-600 mt-1 block max-w-xs">{siteConfig.contact.address}</p>
               </div>
            </div>
          </div>
        </div>
        
        <div class="p-6 bg-red-50 rounded-xl border border-red-100 flex gap-4">
           <AlertCircle className="w-8 h-8 text-red-600 flex-shrink-0" />
           <div>
              <h3 class="font-bold text-red-900 text-lg mb-2">Emergency Response</h3>
              <p class="text-red-700 text-sm mb-4">
                For urgent make-safe works involving water, gas, or structural danger, please call our emergency line immediately.
              </p>
              <Button href={`tel:${siteConfig.contact.phone.replace(/\s/g, '')}`} variant="danger" size="sm">Call Emergency Support</Button>
           </div>
        </div>
      </div>

      {/* Contact Form */}
      <div class="bg-white p-8 rounded-2xl border border-slate-200 shadow-xl shadow-slate-200/40">
        <h2 class="text-2xl font-heading font-bold text-primary mb-6">Send a Message</h2>

        {/* Success message - shown after submission */}
        <div id="contact-success" class="hidden text-center py-10">
          <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-slate-900 mb-2">Message Sent!</h3>
          <p class="text-slate-600">Thanks for getting in touch. We'll get back to you within 1 business day.</p>
        </div>

        <form
          id="contact-form"
          name="contact"
          method="POST"
          data-netlify="true"
          netlify-honeypot="bot-field"
          class="space-y-6"
        >
          <input type="hidden" name="form-name" value="contact" />
          <p class="hidden"><label>Don't fill this out: <input name="bot-field" /></label></p>

          <div class="grid md:grid-cols-2 gap-6">
             <div class="space-y-2">
               <label class="block text-sm font-bold text-slate-700">First Name</label>
               <input type="text" name="first-name" class="w-full h-11 px-4 border border-slate-300 rounded-md focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all" required />
             </div>
             <div class="space-y-2">
               <label class="block text-sm font-bold text-slate-700">Last Name</label>
               <input type="text" name="last-name" class="w-full h-11 px-4 border border-slate-300 rounded-md focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all" required />
             </div>
          </div>
          
          <div class="space-y-2">
            <label class="block text-sm font-bold text-slate-700">Email Address</label>
            <input type="email" name="email" class="w-full h-11 px-4 border border-slate-300 rounded-md focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all" required />
          </div>

          <div class="space-y-2">
            <label class="block text-sm font-bold text-slate-700">Enquiry Type</label>
            <select name="enquiry-type" class="w-full h-11 px-4 border border-slate-300 rounded-md focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all bg-white">
               <option>General Enquiry</option>
               <option>Request a Quote</option>
               <option>Partnership / Recruitment</option>
               <option>Billing Question</option>
            </select>
          </div>

          <div class="space-y-2">
            <label class="block text-sm font-bold text-slate-700">Message</label>
            <textarea name="message" class="w-full h-32 px-4 py-3 border border-slate-300 rounded-md focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all resize-none" required></textarea>
          </div>
          
          <Button type="submit" class="w-full font-bold" size="lg">Send Message</Button>
          <p class="text-xs text-center text-slate-400 mt-4">We typically respond within 1 business day.</p>
        </form>
      </div>

      <script>
        const form = document.getElementById('contact-form') as HTMLFormElement;
        const success = document.getElementById('contact-success');
        form?.addEventListener('submit', async (e) => {
          e.preventDefault();
          const data = new FormData(form);
          await fetch('/', { method: 'POST', headers: { 'Content-Type': 'application/x-www-form-urlencoded' }, body: new URLSearchParams(data as any).toString() });
          form.classList.add('hidden');
          success?.classList.remove('hidden');
        });
      </script>
    </div>
  </section>

  {/* Service Area Map */}
  <section class="py-20 bg-neutral-light">
    <div class="container mx-auto px-4">
      <div class="text-center mb-12">
        <span class="text-accent font-bold tracking-widest uppercase text-sm mb-2 block">Coverage</span>
        <h2 class="text-3xl font-heading font-bold text-primary mb-4">Our Service Areas</h2>
        <p class="text-slate-600 max-w-xl mx-auto">From Whangārei to Dunedin, our network of trade professionals covers New Zealand's major centres.</p>
      </div>

      <div class="flex flex-col lg:flex-row gap-12 items-center justify-center max-w-5xl mx-auto">

        {/* SVG Map of NZ */}
        <div class="flex-shrink-0 w-64">
          <svg viewBox="0 0 110 580" xmlns="http://www.w3.org/2000/svg" class="w-full drop-shadow-lg">
            {/* North Island */}
            <path
              d="M72,60 Q80,55 78,70 Q85,80 82,95 Q88,110 80,125 Q85,140 75,155 Q78,170 68,178 Q72,190 62,198 Q65,210 55,218 Q58,230 50,240 Q52,255 42,265 Q45,275 38,280 Q40,295 30,305 Q35,315 28,322 Q38,330 42,318 Q55,328 60,320 Q70,330 65,342 Q72,350 62,355 Q58,345 50,352 Q45,360 55,365 Q52,375 45,370 Q48,380 40,378 Q44,390 36,392 Q40,405 32,408"
              fill="#CBD5E1" stroke="#94A3B8" stroke-width="1.5" stroke-linejoin="round"
            />
            {/* Cook Strait gap */}
            {/* South Island */}
            <path
              d="M32,408 Q25,415 30,425 Q22,435 28,448 Q20,458 26,470 Q18,480 24,492 Q16,502 22,515 Q14,525 20,538 Q24,548 18,555 Q28,562 22,570 Q35,572 30,560 Q42,568 38,555 Q50,562 46,548 Q58,552 54,538 Q66,542 62,528 Q74,530 68,516 Q78,515 72,500 Q82,495 74,480 Q84,472 76,458 Q86,448 78,435 Q88,422 80,410 Q85,400 76,395 Q80,385 70,382 Q74,370 64,368 Q68,358 58,358 Q55,348 48,352 Q44,342 50,335 Q42,328 46,318 Q36,315 32,322 Q28,308 38,305"
              fill="#CBD5E1" stroke="#94A3B8" stroke-width="1.5" stroke-linejoin="round"
            />

            {/* Service area markers */}
            {serviceAreas.map((area) => (
              <g key={area.name} class="group cursor-pointer">
                {/* Pulse ring */}
                <circle cx={area.x} cy={area.y} r="8" fill="#F97316" opacity="0.2">
                  <animate attributeName="r" values="6;10;6" dur="2.5s" repeatCount="indefinite" />
                  <animate attributeName="opacity" values="0.3;0;0.3" dur="2.5s" repeatCount="indefinite" />
                </circle>
                {/* Dot */}
                <circle cx={area.x} cy={area.y} r="5" fill="#F97316" stroke="white" stroke-width="1.5" />
                {/* Label */}
                <text
                  x={area.x + 8}
                  y={area.y + 4}
                  font-size="7"
                  font-family="sans-serif"
                  font-weight="700"
                  fill="#0F172A"
                  class="select-none"
                >{area.name}</text>
              </g>
            ))}
          </svg>
        </div>

        {/* City list */}
        <div class="grid grid-cols-2 gap-4 w-full max-w-md">
          {serviceAreas.map((area) => (
            <div class="flex items-center gap-3 bg-white rounded-xl px-5 py-4 border border-slate-200 hover:border-accent hover:shadow-md transition-all group">
              <div class="w-3 h-3 rounded-full bg-accent flex-shrink-0 group-hover:scale-125 transition-transform"></div>
              <span class="font-heading font-bold text-primary text-sm">{area.name}</span>
            </div>
          ))}
        </div>

      </div>
    </div>
  </section>

</Layout>
